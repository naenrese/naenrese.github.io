
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>CreateScriptGUI</title>
    </head>
    <body>
        <p>hello!</p>
        <script src="blockly/lib/blockly_compressed.js"></script>
        <script src="blockly/lib/blocks_compressed.js"></script>
        <script src="blockly/lib/javascript_compressed.js"></script>
        <script src="blockly/lib/python_compressed.js"></script>
        <script src="blockly/lib/en.js"></script>
        <script src="blocks.js"></script>
        <script src="blockly.js"></script>
        
        
        <!--  ************************ Blocks **************************** -->
        
        
        
        <!--  ************************ Toolbox **************************** -->
        <script type="text/javascript" src="developer/toolbox.js"></script>
        
        <!--  ************** Blockly Workspace definition ***************** -->
        <script src="developer/workspace.js"></script>
        
        <link rel="stylesheet" href="design.css">
        
        <div class="wrap">
            <div id="blocklyDiv" style="height: 480px; width: 600px;"></div>
            <div class="code_style" id="code"></div>
        </div>
        <p><button id="button1">Download</button></p>
        <script>
    var workspace = Blockly.inject('blocklyDiv',options)
    function myUpdateFunction(event) {
        var code = Blockly.JavaScript.workspaceToCode(workspace);
        document.getElementById('code').innerHTML = '<pre><font size="4" face="Consolas">' + code + '</font></pre>';
    }
    workspace.addChangeListener(myUpdateFunction);

    const button = document.querySelector('button1');
    button.onclick = function() {
        var xml = Blockly.Xml.workspaceToDom(workspace);
        var myBlockXml = Blockly.Xml.domToText(xml); 
        let blob = new Blob([myBlockXml],{type: 'text/xml'});
        let a = document.createElement("a");
        a.href=URL.createObjectURL(blob);
        document.body.appendChild(a); // Firefoxで必要
        a.download='test.xml';
        a.click();
        document.body.removeChild(a); // Firefoxで必要
        URL.revokeObjectURL(a.href)
    }
      </script>
</body>
</html>